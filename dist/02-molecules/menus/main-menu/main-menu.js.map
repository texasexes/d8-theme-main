{"version":3,"sources":["02-molecules/menus/main-menu/main-menu.js"],"names":["remove","toggleClass","length","css","top","append","outerHeight","each","parent","offset","left","outerWidth","parseInt","ready","height","clearTimeout","setTimeout","document","window","width","click","preventDefault","next","resize","removeClass","jQuery","Drupal"],"mappings":"aAAC,YAAqB,CAqDpB,YAA4B,CAC1B,EAAWA,MAAX,EAD0B,CAE1B,EAAa,EACd,CAGD,YAA4B,CAE1B,EAAKC,WAAL,GAF0B,CAK1B,EAASA,WAAT,GAL0B,CAQtB,EAAWC,MARW,CASxB,GATwB,EAcxB,EAAa,EAAE,qCAAF,CAdW,CAexB,EAAWC,GAAX,CAAe,CAACC,KAAD,CAAf,CAfwB,CAgBxB,EAAmBC,MAAnB,GAhBwB,CAkB3B,CASD,YAA0B,CACxB,EAAiB,EAASC,WAAT,EADO,CAExB,EAAYH,GAAZ,CAAgB,CAAC,KAAD,CAAhB,CAFwB,CAIxB,EAAYI,IAAZ,CAAiB,UAAW,CAC1B,GAAM,GAAsB,EAAE,IAAF,EAAQC,MAAR,GAAiBC,MAAjB,GAA0BC,IAA1B,CAAiC,EAAE,IAAF,EAAQC,UAAR,EAA7D,CAEI,GAHsB,EAKxB,EAAE,IAAF,EAAQR,GAAR,aAEH,CAPD,CAQD,CAYD,YAAmC,CACjC,EAAiBS,SAAS,EAAKT,GAAL,CAAS,aAAT,CAAT,CAClB,CAGD,YAAgC,CAC9B,EAAIU,KAAJ,CAAU,UAAW,CACnB,EAAO,EAAIC,MAAJ,EADY,CAEnB,GAFmB,CAGnB,EAAY,GAHO,CAInB,EAASX,GAAT,CAAa,CAAC,KAAD,CAAwB,cAAxB,CAAb,CACD,CALD,CAMD,CA1HmB,GAYd,GAAqB,UAAY,CACrC,GAAM,KAAN,CACA,MAAO,gBAAkC,KAErC,EAAW,2CAF0B,EAInC,IAJmC,EAKrCY,aAAc,IAAd,CALqC,CAOvC,KAAmBC,eACpB,CACF,CAXyB,EAZN,CA0Bd,EAAM,EAAEC,QAAF,CA1BQ,CA2Bd,EAAM,EAAEC,MAAF,CA3BQ,CA4Bd,EAAO,EAAE,MAAF,CA5BO,CA6Bd,EAAiB,EAAE,mBAAF,CA7BH,CA8Bd,EAAqB,EAAE,yBAAF,CA9BP,CA+Bd,EAAW,EAAE,WAAF,CA/BG,CAgCd,EAAc,EAAE,qBAAF,CAhCA,CAiCd,EAAoB,EAAE,wBAAF,CAjCN,CAkCd,EAAU,EAAE,cAAF,CAlCI,CAqChB,EAAO,EAAIJ,MAAJ,EArCS,CAsChB,EAAO,EAAIK,KAAJ,EAtCS,CAuChB,EAAiB,GAvCD,CAwChB,EAAY,OAxCI,CAyChB,EAAiB,EAASb,WAAT,EAzCD,CA6Cd,EAAkB,YA7CJ,CA+Cd,EAAW,UA/CG,CAkDhB,EAAa,EAlDG,CAgFpB,EAAec,KAAf,CAAqB,WAAa,CAChC,EAAEC,cAAF,EADgC,CAEhC,GACD,CAHD,CAhFoB,CAoGpB,GApGoB,CAuGpB,EAAkBD,KAAlB,CAAwB,WAAa,CACnC,EAAEC,cAAF,EADmC,CAEnC,EAAE,IAAF,EAAQpB,WAAR,CA7DsB,6BA6DtB,CAFmC,CAGnC,EAAE,IAAF,EAAQqB,IAAR,CAAa,IAAb,EAAmBrB,WAAnB,GACD,CAJD,CAvGoB,CA4HpB,GA5HoB,CA+HpB,EAAIsB,MAAJ,CAAW,UAAY,CACrB,EAAkB,UAAU,CAC1B,EAAO,EAAIJ,KAAJ,EADmB,CAGf,GAAP,EAHsB,GAKpB,EAAWjB,MALS,EAMtB,GANsB,CASxB,EAAKsB,WAAL,GATwB,CAWxB,EAASA,WAAT,GAXwB,EAc1B,GAd0B,CAe1B,GACD,CAhBD,CAgBG,GAhBH,CAgBQ,2BAhBR,CAiBD,CAlBD,CAqBD,CApJA,EAoJCC,MApJD,CAoJSC,MApJT,C","file":"main-menu.js","sourcesContent":["(function ($, Drupal) {\n\n  // WaitForFinalEvent Function\n  // This function allow us to only perform re-calculations AFTER an event has copmleted.\n  // Below, we'll use it to recalculate values only after the window has been resized, instead of recalculating every pixel change.\n  // Usage:\n  // $(window).resize(function () {\n  //   waitForFinalEvent(function(){\n  //     alert('Resize...');\n  //     //...\n  //   }, 500, \"some unique string\");\n  // });\n  const waitForFinalEvent = (function () {\n    const timers = {};\n    return function (callback, ms, uniqueId) {\n      if (!uniqueId) {\n        uniqueId = \"Don't call this twice without a uniqueId\";\n      }\n      if (timers[uniqueId]) {\n        clearTimeout (timers[uniqueId]);\n      }\n      timers[uniqueId] = setTimeout(callback, ms);\n    };\n  })();\n\n  // Element selectors\n  const dom = $(document);\n  const win = $(window);\n  const body = $('body');\n  const mainMenuToggle = $('.main-menu-toggle');\n  const mainMenuToggleOpen = $('.main-menu-toggle--open');\n  const mainMenu = $('.main-nav');\n  const mainMenuSub = $('.main-menu--level-1');\n  const mainMenuExpandSub = $('.main-menu__expand-sub');\n  const toolbar = $('.toolbar-bar');\n\n  // Calculated values\n  let winH = win.height();\n  let winW = win.width();\n  let bodyPaddingTop = '0';\n  let maxHeight = '100vh';\n  let mainMenuHeight = mainMenu.outerHeight();\n\n  // Classes\n  const mainMenuSubOpen = 'main-menu__expand-sub--open';\n  const mainMenuVisible = 'js-visible';\n  const mainMenuActive = 'js-menu-active';\n  const noscroll = 'noscroll';\n\n  // New elements\n  let mainMenuBg = '';\n\n  // Remove mobile nav background\n  function removeMainMenuBg() {\n    mainMenuBg.remove();\n    mainMenuBg = '';\n  }\n\n  // Show/Hide overlay\n  function mainMenuBgToggle() {\n    // Prevent the background from scrolling when the mobile menu is active\n    body.toggleClass(noscroll);\n\n    // Display main menu\n    mainMenu.toggleClass(mainMenuVisible);\n\n    // Remove the overlay if it exists\n    if (mainMenuBg.length) {\n      removeMainMenuBg();\n    }\n\n    // Add overlay if needed\n    else {\n      mainMenuBg = $('<span class=\"js-main-menu-close\" />');\n      mainMenuBg.css({top: bodyPaddingTop});\n      mainMenuToggleOpen.append(mainMenuBg);\n    }\n  };\n\n  // Main Menu\n  mainMenuToggle.click(function (e) {\n    e.preventDefault();\n    mainMenuBgToggle();\n  });\n\n  // Calculate the subnav position for the desktop view\n  function subNavPosition() {\n    mainMenuHeight = mainMenu.outerHeight();\n    mainMenuSub.css({'top': mainMenuHeight})\n    // Ensure dropdown nav is always inside the viewport (prevents horizontal scrolling)\n    mainMenuSub.each(function() {\n      const subnavRightPosition = $(this).parent().offset().left + $(this).outerWidth();\n      // If the right edge of the subnav is outside the viewport\n      if (subnavRightPosition > winW) {\n        // Set element right position = 0\n        $(this).css({'right': \"0\"});\n      }\n    });\n  };\n\n  subNavPosition();\n\n  // Display Sub-nav\n  mainMenuExpandSub.click(function (e) {\n    e.preventDefault();\n    $(this).toggleClass(mainMenuSubOpen);\n    $(this).next('ul').toggleClass(mainMenuVisible);\n  });\n\n  // Calculate body padding top (to accommodate the admin menu)\n  function calculateBodyPaddingTop() {\n    bodyPaddingTop = parseInt(body.css('padding-top'));\n  };\n\n  // Set the height and position of the main-nav\n  function calculateMenuHeights() {\n    dom.ready(function() {\n      winH = win.height();\n      calculateBodyPaddingTop();\n      maxHeight = winH - bodyPaddingTop;\n      mainMenu.css({'top': bodyPaddingTop, 'max-height': maxHeight});\n    });\n  };\n\n  calculateMenuHeights();\n\n  // Update everything when the window is resized\n  win.resize(function () {\n    waitForFinalEvent(function(){\n      winW = win.width();\n      // If desktop width remove all mobile menu stuff\n      if (winW > 767) {\n        // Remove background overlay\n        if (mainMenuBg.length) {\n          removeMainMenuBg();\n        }\n        // Remove noscroll class from body\n        body.removeClass(noscroll);\n        // Hide mobile menu\n        mainMenu.removeClass(mainMenuVisible);\n      }\n\n      calculateMenuHeights();\n      subNavPosition();\n    }, 100, \"Main menu - window resize\");\n  });\n\n\n}(jQuery, Drupal));\n"]}