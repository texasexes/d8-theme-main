{"version":3,"sources":["02-molecules/menus/main-menu/main-menu.js"],"names":["remove","toggleClass","length","get","scrollIntoView","css","top","append","parseInt","each","clone","insertAfter","height","closest","ready","clearTimeout","setTimeout","document","window","width","outerHeight","addClass","click","preventDefault","children","next","resize","removeClass","scroll","scrollTop","jQuery","Drupal"],"mappings":"aAAC,YAAqB,CA2EpB,YAA4B,CAC1B,EAAWA,MAAX,EAD0B,CAE1B,EAAa,EACd,CAGD,YAA4B,CAE1B,EAAKC,WAAL,GAF0B,CAK1B,EAASA,WAAT,GAL0B,CAQ1B,EAAqB,EAAE,YAAF,CARK,CAStB,EAAmBC,MATG,EAUxB,EAAmBC,GAAnB,CAAuB,CAAvB,EAA0BC,cAA1B,EAVwB,CActB,EAAWF,MAdW,CAexB,GAfwB,EAmBxB,EAAa,EAAE,qCAAF,CAnBW,CAoBxB,EAAWG,GAAX,CAAe,CAACC,KAAD,CAAf,CApBwB,CAqBxB,EAAmBC,MAAnB,GArBwB,CAuB3B,CA0BD,YAAmC,CACjC,EAAiBC,SAAS,EAAKH,GAAL,CAAS,aAAT,CAAT,CAAkC,EAAlC,CAClB,CAGD,YAAiC,CAC/B,EAAe,CADgB,CAED,OAA1B,IAAOA,GAAP,CAAW,UAAX,CAF2B,GAG7B,EAAeG,SAAS,EAAOH,GAAP,CAAW,QAAX,CAAT,CAA+B,EAA/B,CAHc,CAKhC,CAED,YAAmC,CACjC,KAAoBI,IAApB,CAAyB,UAAY,CACnC,EAAe,EAAE,IAAF,EAAQC,KAAR,EADoB,CAEnC,EAAaL,GAAb,4CAAoEM,WAApE,CAAgF,IAAhF,CAFmC,CAGnC,EAAwB,EAAaC,MAAb,EAHW,CAInC,EAAaZ,MAAb,EAJmC,CAKnC,EAAE,IAAF,EAAQa,OAAR,IAA6BR,GAA7B,CAAiC,CAAC,cAAD,CAAjC,CACD,CAND,CAOD,CAGD,YAAgC,CAC9B,EAAIS,KAAJ,CAAU,UAAW,CACnB,EAAON,SAAS,EAAII,MAAJ,EAAT,CAAuB,EAAvB,CADY,CAEnB,GAFmB,CAGnB,GAHmB,CAInB,EAAY,GAJO,CAKnB,EAASP,GAAT,CAAa,CAAC,KAAD,CAAwB,cAAxB,CAAb,CALmB,CAMnB,EAAOA,GAAP,CAAW,CAAC,KAAD,CAAX,CANmB,CAOnB,EAAgBA,GAAhB,CAAoB,CAAC,cAAD,CAApB,CAPmB,CAQnB,GACD,CATD,CAUD,CApKmB,GAYd,GAAqB,UAAY,CACrC,GAAM,KAAN,CACA,MAAO,gBAAkC,KAErC,EAAW,2CAF0B,EAInC,IAJmC,EAKrCU,aAAc,IAAd,CALqC,CAOvC,KAAmBC,eACpB,CACF,CAXyB,EAZN,CA0Bd,EAAM,EAAEC,QAAF,CA1BQ,CA2Bd,EAAM,EAAEC,MAAF,CA3BQ,CA4Bd,EAAO,EAAE,MAAF,CA5BO,CA6Bd,EAAiB,EAAE,mBAAF,CA7BH,CA8Bd,EAAqB,EAAE,yBAAF,CA9BP,CA+Bd,EAAW,EAAE,WAAF,CA/BG,CAgCd,EAAc,EAAE,sBAAF,CAhCA,CAiCd,EAAc,EAAE,sBAAF,CAjCA,CAkCd,EAAmB,EAAE,4BAAF,CAlCL,CAmCd,EAAkB,EAAE,4BAAF,CAnCJ,CAoCd,EAAoB,EAAE,wBAAF,CApCN,CAqCd,EAAoB,EAAE,wBAAF,CArCN,CAsCd,EAAkB,EAAE,sBAAF,CAtCJ,CAuCd,EAAkB,EAAE,sBAAF,CAvCJ,CAwCd,EAAS,EAAE,iBAAF,CAxCK,CAyCd,EAAmB,EAAE,qBAAF,CAzCL,CA0Cd,EAAkB,EAAE,mBAAF,CA1CJ,CA6ChB,EAAOV,SAAS,EAAII,MAAJ,EAAT,CAAuB,EAAvB,CA7CS,CA8ChB,EAAOJ,SAAS,EAAIW,KAAJ,EAAT,CAAsB,EAAtB,CA9CS,CA+ChB,EAAiB,CA/CD,CAgDhB,EAAe,CAhDC,CAiDhB,EAAY,OAjDI,CAkDhB,EAAiB,EAASC,WAAT,EAlDD,CAmDhB,EAAqB,EAAE,YAAF,CAnDL,CAoDhB,EAAe,EAAE,EAAF,CApDC,CAqDhB,EAAwB,GArDR,CAsDhB,EAAmB,CAtDH,CA0Dd,EAAkB,2BA1DJ,CA2Dd,EAAkB,2BA3DJ,CA4Dd,EAAc,YA5DA,CA8Dd,EAAW,UA9DG,CAiEhB,EAAa,EAjEG,CAoEpB,EAAE,gFAAF,EAAoFC,QAApF,GApEoB,CAqEpB,EAAE,uDAAF,EAA2DA,QAA3D,GArEoB,CAuEpB,EAAE,gFAAF,EAAoFA,QAApF,GAvEoB,CAwEpB,EAAE,uDAAF,EAA2DA,QAA3D,GAxEoB,CA6GpB,EAAeC,KAAf,CAAqB,WAAa,CAChC,EAAEC,cAAF,EADgC,CAEhC,GAGD,CALD,CA7GoB,CAqHpB,EAAkBD,KAAlB,CAAwB,WAAa,CACnC,EAAEC,cAAF,EADmC,CAEnC,EAAE,IAAF,EAAQC,QAAR,IAAkCvB,WAAlC,GAFmC,CAGnC,EAAE,IAAF,EAAQwB,IAAR,IAA0BxB,WAA1B,GACD,CAJD,CArHoB,CA2HpB,EAAkBqB,KAAlB,CAAwB,WAAa,CACnC,EAAEC,cAAF,EADmC,CAEnC,EAAE,IAAF,EAAQC,QAAR,IAAkCvB,WAAlC,GAFmC,CAGnC,EAAE,IAAF,EAAQwB,IAAR,IAA0BxB,WAA1B,GACD,CAJD,CA3HoB,CAsKpB,GAtKoB,CAyKpB,EAAIyB,MAAJ,CAAW,UAAY,CACrB,EAAkB,UAAU,CAC1B,EAAOlB,SAAS,EAAIW,KAAJ,EAAT,CAAsB,EAAtB,CADmB,CAGf,GAAP,EAHsB,GAKpB,EAAWjB,MALS,EAMtB,GANsB,CASxB,EAAKyB,WAAL,GATwB,CAWxB,EAASA,WAAT,GAXwB,EAc1B,GACD,CAfD,CAeG,GAfH,CAeQ,2BAfR,CAgBD,CAjBD,CAzKoB,CA4LpB,GA5LoB,CA6LpB,GAAI,EAAJ,CAEA,EAAIC,MAAJ,CAAW,UAAY,CACpB,EAAmBpB,SAAS,EAAIqB,SAAJ,EAAT,CADC,CAEhB,KAAwB,EAAmB,GAF3B,CAGlB,EAAOR,QAAP,CAAgB,UAAhB,CAHkB,CAIT,KAAwB,EAAE,IAAF,CAJf,EAKlB,EAAOM,WAAP,CAAmB,UAAnB,CALkB,CAOpB,GACD,CARF,CAUD,CAzMA,EAyMCG,MAzMD,CAyMSC,MAzMT,C","file":"main-menu.js","sourcesContent":["(function ($, Drupal) {\n\n  // WaitForFinalEvent Function\n  // This function allow us to only perform re-calculations AFTER an event has copmleted.\n  // Below, we'll use it to recalculate values only after the window has been resized, instead of recalculating every pixel change.\n  // Usage:\n  // $(window).resize(function () {\n  //   waitForFinalEvent(function(){\n  //     alert('Resize...');\n  //     //...\n  //   }, 500, \"some unique string\");\n  // });\n  const waitForFinalEvent = (function () {\n    const timers = {};\n    return function (callback, ms, uniqueId) {\n      if (!uniqueId) {\n        uniqueId = \"Don't call this twice without a uniqueId\";\n      }\n      if (timers[uniqueId]) {\n        clearTimeout (timers[uniqueId]);\n      }\n      timers[uniqueId] = setTimeout(callback, ms);\n    };\n  })();\n\n  // Element selectors\n  const dom = $(document);\n  const win = $(window);\n  const body = $('body');\n  const mainMenuToggle = $('.main-menu-toggle');\n  const mainMenuToggleOpen = $('.main-menu-toggle--open');\n  const mainMenu = $('.main-nav');\n  const mainMenuSub = $('.main-menu__dropdown');\n  const sideMenuSub = $('.side-menu__dropdown');\n  const sideMenuSubInner = $('.side-menu__dropdown-inner');\n  const mainMenuWithSub = $('.main-menu__item--with-sub');\n  const mainMenuExpandSub = $('.main-menu__expand-sub');\n  const sideMenuExpandSub = $('.side-menu__expand-sub');\n  const mainMenuSubIcon = $('.main-menu__sub-icon');\n  const sideMenuSubIcon = $('.side-menu__sub-icon');\n  const header = $('.header-wrapper');\n  const contentTopRegion = $('.content-top-region');\n  const layoutContainer = $('.layout-container');\n\n  // Calculated values\n  let winH = parseInt(win.height(), 10);\n  let winW = parseInt(win.width(), 10);\n  let bodyPaddingTop = 0;\n  let headerHeight = 0;\n  let maxHeight = '100vh';\n  let mainMenuHeight = mainMenu.outerHeight();\n  let mainMenuActiveItem = $('.is-active');\n  let dummyElement = $('');\n  let dummyElementMaxHeight = '0';\n  let currentScrollTop = 0;\n  let totalHeightToSkip = 0;\n\n  // Classes\n  const mainMenuSubOpen = 'main-menu__sub-icon--open';\n  const sideMenuSubOpen = 'side-menu__sub-icon--open';\n  const menuVisible = 'js-visible';\n  const mainMenuActive = 'js-menu-active';\n  const noscroll = 'noscroll';\n\n  // New elements\n  let mainMenuBg = '';\n\n  // Expand parent items if current page is the active menu item\n  $('.main-menu__item--active-trail > .main-menu__expand-sub > .main-menu__sub-icon').addClass(mainMenuSubOpen);\n  $('.main-menu__item--active-trail > .main-menu__dropdown').addClass(menuVisible);\n\n  $('.side-menu__item--active-trail > .side-menu__expand-sub > .side-menu__sub-icon').addClass(sideMenuSubOpen);\n  $('.side-menu__item--active-trail > .side-menu__dropdown').addClass(menuVisible);\n\n  // Remove mobile nav background\n  function removeMainMenuBg() {\n    mainMenuBg.remove();\n    mainMenuBg = '';\n  }\n\n  // Show/Hide overlay\n  function mainMenuBgToggle() {\n    // Prevent the background from scrolling when the mobile menu is active\n    body.toggleClass(noscroll);\n\n    // Display main menu\n    mainMenu.toggleClass(menuVisible);\n\n    //Scroll to main menu items\n    mainMenuActiveItem = $('.is-active');\n    if (mainMenuActiveItem.length) {\n      mainMenuActiveItem.get(0).scrollIntoView();\n    }\n\n    // Remove the overlay if it exists\n    if (mainMenuBg.length) {\n      removeMainMenuBg();\n    }\n    // Add overlay if needed\n    else {\n      mainMenuBg = $('<span class=\"js-main-menu-close\" />');\n      mainMenuBg.css({top: bodyPaddingTop});\n      mainMenuToggleOpen.append(mainMenuBg);\n    }\n  };\n\n\n\n  // Main Menu\n  mainMenuToggle.click(function (e) {\n    e.preventDefault();\n    mainMenuBgToggle();\n    // expandParents();\n\n  });\n\n  // Display Sub-nav\n  mainMenuExpandSub.click(function (e) {\n    e.preventDefault();\n    $(this).children(mainMenuSubIcon).toggleClass(mainMenuSubOpen);\n    $(this).next(mainMenuSub).toggleClass(menuVisible);\n  });\n  // Display Sub-nav\n  sideMenuExpandSub.click(function (e) {\n    e.preventDefault();\n    $(this).children(sideMenuSubIcon).toggleClass(sideMenuSubOpen);\n    $(this).next(sideMenuSub).toggleClass(menuVisible);\n  });\n\n  // Calculate body padding top (to accommodate the admin menu)\n  function calculateBodyPaddingTop() {\n    bodyPaddingTop = parseInt(body.css('padding-top'), 10);\n  };\n\n  // Calculate header height (to accommodate the fixed header bar)\n  function calculateHeaderHeight() {\n    headerHeight = 0;\n    if (header.css('position') == 'fixed') {\n      headerHeight = parseInt(header.css('height'), 10);\n    }\n  };\n\n  function setSideMenuSubMaxHeight() {\n    $(sideMenuSubInner).each(function () {\n      dummyElement = $(this).clone();\n      dummyElement.css({'visibility': 'hidden', 'position': 'absolute' }).insertAfter(this);\n      dummyElementMaxHeight = dummyElement.height();\n      dummyElement.remove();\n      $(this).closest(sideMenuSub).css({'max-height': dummyElementMaxHeight});\n    });\n  }\n\n  // Set the height and position of the main-nav and header bar\n  function calculateMenuHeights() {\n    dom.ready(function() {\n      winH = parseInt(win.height(), 10);\n      calculateBodyPaddingTop();\n      calculateHeaderHeight();\n      maxHeight = winH - bodyPaddingTop;\n      mainMenu.css({'top': bodyPaddingTop, 'max-height': maxHeight});\n      header.css({'top': bodyPaddingTop});\n      layoutContainer.css({'margin-top': headerHeight});\n      setSideMenuSubMaxHeight();\n    });\n  };\n\n  calculateMenuHeights();\n\n  // Update everything when the window is resized\n  win.resize(function () {\n    waitForFinalEvent(function(){\n      winW = parseInt(win.width(), 10);\n      // If desktop width remove all mobile menu stuff\n      if (winW > 900) {\n        // Remove background overlay\n        if (mainMenuBg.length) {\n          removeMainMenuBg();\n        }\n        // Remove noscroll class from body\n        body.removeClass(noscroll);\n        // Hide mobile menu\n        mainMenu.removeClass(menuVisible);\n      }\n      // setHeaderMarginTop();\n      calculateMenuHeights();\n    }, 100, \"Main menu - window resize\");\n  });\n\n  calculateBodyPaddingTop();\n  var c;\n\n  win.scroll(function () {\n     currentScrollTop = parseInt(win.scrollTop());\n     if (c < currentScrollTop && currentScrollTop > bodyPaddingTop + headerHeight) {\n       header.addClass(\"scrollUp\");\n     } else if (c > currentScrollTop && !(currentScrollTop <= headerHeight)) {\n       header.removeClass(\"scrollUp\");\n     }\n     c = currentScrollTop;\n   });\n\n}(jQuery, Drupal));\n"]}